---
import { useStoryblokApi } from "@storyblok/astro";
import Hamburger from "../components/Hamburger.astro";
import ArrowUpRightIcon from "../components/ArrowUpRightIcon.astro";
const storyblokApi = useStoryblokApi();
const { data } = await storyblokApi.get("cdn/stories/config", {
  version: "draft",
  resolve_links: "url",
});
const navbar = data?.story?.content.Navbar;
---

<header class="w-full h-16 sm:h-20 lg:h-24 sticky top-0 bg-zinc-900/70 z-[99]">
  <div class="w-full h-full backdrop-blur-lg">
    <div class="container h-full mx-auto flex items-center justify-between">
      <a href="/">
        <h1
          class="hover:text-teal-500 transition ease-in-out duration-300 text-2xl sm:text-3xl lg:text-4xl tracking-wide font-space">
          galactica
        </h1>
      </a>
      <nav class="sm:inline-block hidden">
        <ul class="flex space-x-8 text-lg">
          {
            navbar.map(
              (menu: { link: { cached_url: any; story: { name: any } } }) => (
                <li>
                  <a
                    href={`/${menu.link.cached_url}`}
                    class="hover:shadow-bottom transition ease-in-out duration-500">
                    {menu.link.story.name}
                  </a>
                </li>
              )
            )
          }
        </ul>
      </nav>
      <Hamburger />
    </div>
  </div>

  <div
    id="nav-links"
    class="hidden backdrop-blur-lg border rounded-md border-zinc-300/10 bg-zinc-900/70 absolute inset-x-0 max-h-max z-50 p-8 overflow-hidden select-none lg:hidden">
    <ul class="flex flex-col gap-4">
      <li class="flex gap-4">
        <a href="/" class="font-medium text-xl"> Home</a>
      </li>

      {
        navbar.map(
          (linkItem: {
            link: { story: { name: unknown }; cached_url: any };
          }) => (
            <li class="flex gap-4">
              <a
                href={`/${linkItem.link.cached_url}`}
                class="font-medium text-xl">
                {linkItem.link.story?.name}
              </a>
            </li>
          )
        )
      }
    </ul>
  </div>
</header>

<script>
  const hamburger = document.getElementById("hamburger");
  const closeButton = document.getElementById("close-button");
  const navLinks = document.getElementById("nav-links");

  function toggleMenu() {
    navLinks?.classList.toggle("hidden");
    hamburger?.classList.toggle("hidden");
    closeButton?.classList.toggle("hidden");
  }

  if (hamburger && closeButton && navLinks) {
    hamburger.addEventListener("click", toggleMenu);
    closeButton.addEventListener("click", toggleMenu);
  }
</script>
